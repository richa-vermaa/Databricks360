# Dashboards 

For this exercise, we will expand on the scope of the queries we did in the Data Discovery lab to build our dashboards to visualize the following fields in the 'nyc_yellow_taxi_delta' table.
* Passenger Count
* Trip Time
* Trip Distance
* Fare Amount
* Tip Percentage

1. To create a Dashboard, go to 'Dashboards' item in the left navigation bar and then click the Create Dashboard button in the upper right.<BR>
NOTE: By default, your new dashboard is automatically named with its creation timestamp and stored in your /Workspace/Users/<username> directory

2. Click on the Dashboard title in the top center and rename your dashboard to 'NYC Taxi Cab Analysis'.  When finished, your screen should look like the following.
<BR>&nbsp;<BR>
![picture alt](/imagery/dwh_14_01_dashboard_name.png)
<br>

3. Let's define our dataset by clicking on the Data tab in the upper left and click the '+ Create from SQL' button and add the following code:
    ```sql
    SELECT 
        CASE 
            WHEN HOUR(tpep_pickup_datetime) BETWEEN 0 AND 5 THEN '1-Early Morning'
            WHEN HOUR(tpep_pickup_datetime) BETWEEN 6 AND 9 THEN '2-Morning Rush Hour'
            WHEN HOUR(tpep_pickup_datetime) BETWEEN 10 AND 11 THEN '3-Morning'
            WHEN HOUR(tpep_pickup_datetime) BETWEEN 12 AND 15 THEN '4-Afternoon'
            WHEN HOUR(tpep_pickup_datetime) BETWEEN 16 AND 18 THEN '5-Evening Rush Hour'
            WHEN HOUR(tpep_pickup_datetime) BETWEEN 19 AND 23 THEN '6-Night'
        END AS time_of_day,
        CONCAT(EXTRACT(DAYOFWEEK FROM tpep_pickup_datetime), '-', DATE_FORMAT(tpep_pickup_datetime, 'E'))  AS day_of_week,
        ROUND(AVG(passenger_count), 2) AS avg_passenger_count,
        ROUND(AVG((unix_timestamp(tpep_dropoff_datetime) - unix_timestamp(tpep_pickup_datetime)) / 60), 1) AS avg_trip_time_minutes,
        ROUND(AVG(trip_distance), 2) AS avg_trip_distance,
        ROUND(AVG(fare_amount), 2) AS avg_fare_amount,
        ROUND(AVG(try_divide(tip_amount, fare_amount)), 2) * 100 AS avg_tip_percentage
        FROM default.nyc_yellow_taxi_delta
        GROUP BY 
        CONCAT(EXTRACT(DAYOFWEEK FROM tpep_pickup_datetime), '-', DATE_FORMAT(tpep_pickup_datetime, 'E')),
        CASE 
            WHEN HOUR(tpep_pickup_datetime) BETWEEN 0 AND 5 THEN '1-Early Morning'
            WHEN HOUR(tpep_pickup_datetime) BETWEEN 6 AND 9 THEN '2-Morning Rush Hour'
            WHEN HOUR(tpep_pickup_datetime) BETWEEN 10 AND 11 THEN '3-Morning'
            WHEN HOUR(tpep_pickup_datetime) BETWEEN 12 AND 15 THEN '4-Afternoon'
            WHEN HOUR(tpep_pickup_datetime) BETWEEN 16 AND 18 THEN '5-Evening Rush Hour'
            WHEN HOUR(tpep_pickup_datetime) BETWEEN 19 AND 23 THEN '6-Night'
        END
        ORDER BY 
        day_of_week, time_of_day
    ```

4. Name your dataset 'NYC Taxi Summarized'.  WHen finished, your Dataset should look like the following:
<BR>&nbsp;<BR>
![picture alt](/imagery/dwh_14_02_dataset.png)
<br>

5. Next click on the 'Canvas tab' in the upper left of the dashboard window.  We have a few options when working within the canvas window:
<BR>&nbsp;<BR>
![picture alt](/imagery/dwh_14_03_canvas.png)
<br>

6. Click 'Add a visualization' and add it to the upper left section of the window and set the following properties:<BR>
    a. Visualization: Pivot<BR>
    b. Columns: time_of_day<BR>
    c. Values<BR>
    &nbsp;&nbsp;&nbsp;&nbsp;i. AVG(avg_passenger_count)<BR>
    &nbsp;&nbsp;&nbsp;&nbsp;ii. AVG(avg_fare_amount)<BR>
    &nbsp;&nbsp;&nbsp;&nbsp;iii. AVG(avg_tip_percentage)<BR>
    &nbsp;&nbsp;&nbsp;&nbsp;iv. AVG(avg_trip_distance)<BR>
    &nbsp;&nbsp;&nbsp;&nbsp;v. AVG(avg_trip_time_minutes)<BR>
    NOTE:  THe values will first show as SUM(field), click on the value field to change it to AVG.

    When finished, your visual should look like the following: 
    <BR>&nbsp;<BR>
    ![picture alt](/imagery/dwh_14_04_pivot.png)
    <br>






